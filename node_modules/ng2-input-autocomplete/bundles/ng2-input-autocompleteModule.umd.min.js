!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("@angular/forms")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","@angular/forms"],t):t(e["ng2-input-autocompleteModule"]={},e.ng.core,e.ng.common,e.ng.forms)}(this,function(e,t,n,i){"use strict";var o=function(){function e(e){this.selectEvent=new t.EventEmitter,this.inputChangedEvent=new t.EventEmitter,this.thisElement=e.nativeElement,this.selectedIndex=0,this.showAutoComplete=!1,this.value=""}return e.prototype.ngOnInit=function(){this.placeholder="autocomplete",this.inputElement=this.thisElement.querySelector("input"),this.isNull(this.config)||(this.isNull(this.config.placeholder)||(this.placeholder=this.config.placeholder),this.isNull(this.config.sourceField)||(this.sourceField=this.config.sourceField)),this.filterItems(this.value),this.inputElement.focus()},e.prototype.ngOnChanges=function(){this.filterItems(this.value)},e.prototype.enterText=function(e){var t=this.candidates.length;switch(e.keyCode){case 27:this.showAutoComplete=!1;break;case 38:this.selectedIndex=(t+this.selectedIndex-1)%t;break;case 40:this.selectedIndex=(t+this.selectedIndex+1)%t;break;case 13:this.candidates.length>0&&this.onSelect(this.selectedIndex),e.preventDefault();break;default:this.value=e.target.value,this.inputChangedEvent.emit(this.value)}},e.prototype.onSelect=function(e){this.showAutoComplete=!1,this.value=this.candiatesLabels[e],this.selectEvent.emit(this.candidates[e])},e.prototype.filterItems=function(e){var t=this.sourceField,n=this.filterItem;this.items&&(this.candidates=this.items.filter(function(i){return n(i,t,e)}),this.buildLabels())},e.prototype.getFieldValue=function(e,t){if("string"==typeof e)return e;if(t instanceof Array){var n=e;return t.forEach(function(e){n=null!==n&&n!==undefined&&null!==n[e]&&n[e]!==undefined?n[e]:""}),n}return e[t]||""},e.prototype.isNull=function(e){return null===e||e===undefined},e.prototype.buildLabels=function(){var e=this.sourceField,t=this.getFieldValue;this.candiatesLabels=this.candidates.map(function(n){return t(n,e)})},e.prototype.filterItem=function(e,t,n){return null===n||n===undefined||0===n.length||("string"==typeof e?i=e:t instanceof Array?(i=e,t.forEach(function(e){i=null!==i&&i!==undefined&&null!==i[e]&&i[e]!==undefined?i[e]:""})):i=e[t]||"",i.toLowerCase().indexOf(n.toLowerCase())>=0);var i},e}();o.decorators=[{type:t.Component,args:[{selector:"ng2-input-autocomplete",template:'\n  <div class="autocomplete">\n    <input type="text"\n      placeholder="{{placeholder}}"\n      (blur)="showAutoComplete = false;"\n      (focus)="showAutoComplete = true;"\n      [value]="value"\n      (keyup)="enterText($event)">\n    <ul *ngIf="showAutoComplete && candidates && candidates.length > 0">\n      <li *ngFor="let candidate of candidates; let idx = index"\n        [ngClass]="{ active: (idx === selectedIndex) }"\n        (mouseover)="selectedIndex = idx;"\n        (mousedown)="onSelect(idx)">\n        {{candiatesLabels[idx]}}\n      </li>\n    </ul>\n  </div>',styles:[".autocomplete ul {\n       position: absolute;\n       left: 0;\n       width: 100%;\n       border-left: 1px solid #888;\n       border-right: 1px solid #888;\n       border-bottom: 1px solid #888;\n       list-style: none;\n       padding-left: 0px;\n       margin-top: 2px;\n       background-color: #fff;\n       z-index: 100;\n     }\n     .autocomplete li {\n       text-align: left;\n       list-style: none;\n       width: 100%;\n       padding: 0.4em 0 0.4em 0;\n     }\n     .autocomplete li.active {\n       width: 100%;\n       background-color: #4bf;\n     }\n\n     .autocomplete .highlight {\n       background-color: #e2e2e2;\n     }\n     .autocomplete li.active .highlight {\n       background: #666;\n       color: #fff;\n     }"]}]}],o.ctorParameters=function(){return[{type:t.ElementRef}]},o.propDecorators={items:[{type:t.Input}],config:[{type:t.Input}],selectEvent:[{type:t.Output}],inputChangedEvent:[{type:t.Output}]};var s=function(){function e(e,n){var i=this;this.resolver=e,this.viewContainerRef=n,this.ngModelChange=new t.EventEmitter,this.inputChangedEvent=new t.EventEmitter,this.selectEvent=new t.EventEmitter,this.hideAutocomplete=function(e){i.componentRef&&((!e||e.target!==i.thisElement&&"click"===e.type)&&(i.componentRef.destroy(),i.componentRef=undefined),i.inputElement.tabIndex<0&&(i.inputElement.tabIndex=i.tabIndex))},this.onInputChanged=function(e){i.inputElement.value=e,e!==i.ngModel&&i.ngModelChange.emit(e),i.componentRef.instance.filterItems(e),i.inputChangedEvent.emit(e)},this.onSelect=function(e){var t=i.componentRef.instance.value;t!==i.ngModel&&i.ngModelChange.emit(t),i.selectEvent.emit(e),i.inputElement&&(i.inputElement.value=""+t),i.hideAutocomplete()},this.thisElement=this.viewContainerRef.element.nativeElement}return e.prototype.ngOnInit=function(){"form"!==this.thisElement.tagName.toLowerCase()&&this.createDiv()},e.prototype.ngOnDestroy=function(){this.componentRef&&(this.componentRef.instance.selectEvent.unsubscribe(),this.componentRef.instance.inputChangedEvent.unsubscribe()),document.removeEventListener("click",this.hideAutocomplete)},e.prototype.ngOnChanges=function(e){if(e.items&&this.componentRef){var t=this.componentRef.instance;t.items=e.items.currentValue,t.filterItems(t.value)}},e.prototype.showAutocomplete=function(e){this.hideAutocomplete(),e===this.thisElement&&this.createAutocomplete()},e.prototype.createDiv=function(){var e=document.createElement("div");e.style.display="inline-block",e.style.position="relative",this.thisElement.parentElement.insertBefore(e,this.thisElement.nextSibling),e.appendChild(this.thisElement),document.addEventListener("click",this.hideAutocomplete)},e.prototype.createAutocomplete=function(){var e=this.resolver.resolveComponentFactory(o);this.componentRef=this.viewContainerRef.createComponent(e);var t=this.componentRef.instance;if(t.config=this.config,t.items=this.items,t.selectEvent.subscribe(this.onSelect),t.inputChangedEvent.subscribe(this.onInputChanged),this.autocompleteElement=this.componentRef.location.nativeElement,this.autocompleteElement.style.display="none",this.inputElement=this.thisElement,"INPUT"!==this.thisElement.tagName&&this.autocompleteElement&&(this.inputElement=this.thisElement.querySelector("input"),this.inputElement.parentElement.insertBefore(this.autocompleteElement,this.inputElement.nextSibling)),t.value=this.inputElement.value,this.tabIndex=this.inputElement.tabIndex,this.inputElement.tabIndex=-100,this.componentRef){var n=this.thisElement.getBoundingClientRect(),i=this.autocompleteElement.style;i.width=n.width+"px",i.position="absolute",i.zIndex="1",i.top="0",i.left="0",i.display="inline-block"}},e}();s.decorators=[{type:t.Directive,args:[{selector:"[autocomplete]"}]}],s.ctorParameters=function(){return[{type:t.ComponentFactoryResolver},{type:t.ViewContainerRef}]},s.propDecorators={config:[{type:t.Input}],items:[{type:t.Input}],ngModel:[{type:t.Input}],ngModelChange:[{type:t.Output}],inputChangedEvent:[{type:t.Output}],selectEvent:[{type:t.Output}],showAutocomplete:[{type:t.HostListener,args:["click",["$event.target"]]},{type:t.HostListener,args:["focus",["$event.target"]]}]};var l=function(){function e(){}return e.forRoot=function(){return{ngModule:e}},e}();l.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,i.FormsModule],declarations:[o,s],exports:[o,s],entryComponents:[o]}]}],l.ctorParameters=function(){return[]},e.AutocompleteComponent=o,e.AutocompleteDirective=s,e.AutocompleteModule=l,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ng2-input-autocompleteModule.umd.min.js.map
